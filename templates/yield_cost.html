<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Yield & Cost Estimation</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">

  <style>
    body {
      background-image: url("/static/background.jpg");
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
    }
    .fade-in {
      animation: fadeIn 0.8s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center px-4 py-10 font-sans text-gray-800 relative">

  <!-- ğŸŒ Language Switcher (Top-Right Corner) -->
  <div id="google_translate_element" class="absolute top-4 right-4 z-50"></div>

  <div class="bg-white bg-opacity-90 backdrop-blur-md p-8 rounded-3xl shadow-2xl max-w-3xl w-full fade-in">

    <h2 class="text-4xl font-bold text-green-800 text-center mb-8">ğŸŒ¾ Yield & Cost Estimation</h2>

    <!-- Yield & Cost Form -->
    <form action="/yield_cost" method="POST" onsubmit="return validateForm()" class="space-y-6">
      
      <!-- Crop Selector -->
      <div>
        <label class="block text-lg font-semibold text-gray-700 mb-2">
          ğŸŒ± Select Crop:
        </label>
        <select name="crop" required 
                class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition">
          <option value="">-- Choose a Crop --</option>
          {% for available_crop in all_crops %}
          <option value="{{ available_crop }}" {% if available_crop == crop %}selected{% endif %}>
            {{ available_crop }}
          </option>
          {% endfor %}
        </select>
      </div>

      <!-- Land Area Input -->
      <div>
        <label class="block text-lg font-semibold text-gray-700 mb-2">
          ğŸ“ Enter Land Area (in acres):
        </label>
        <input type="number" step="0.1" name="land_area" id="land_area" 
               value="{{ land_area if land_area else '' }}" 
               required 
               placeholder="e.g., 5.0"
               class="w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-transparent outline-none transition" />
      </div>

      <!-- Submit Button -->
      <div class="text-center">
        <button type="submit" class="bg-gradient-to-r from-green-600 to-green-700 text-white text-lg px-10 py-4 rounded-full font-bold hover:from-green-700 hover:to-green-800 transition duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
          ğŸ“Š Calculate Yield & Cost
        </button>
      </div>
    </form>

    {% if crop and cost_details %}
    <div class="mt-10 space-y-6">

      <!-- Selected Crop Info -->
      <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-5 rounded-xl shadow-lg">
        <h3 class="text-2xl font-bold mb-1">ğŸŒ¾ Selected Crop</h3>
        <p class="text-3xl font-bold">{{ crop }}</p>
        <p class="text-sm text-green-100 mt-2">Land Area: {{ land_area }} acres</p>
      </div>

      <div class="bg-green-50 p-6 rounded-xl shadow-lg border-2 border-green-200">
        <h3 class="text-2xl font-bold text-green-800 mb-3 flex items-center gap-2">
          <span class="text-3xl">ğŸŒ¿</span> Estimated Crop Yield
        </h3>
        <p class="text-4xl font-bold text-green-700">{{ "%.2f"|format(estimated_yield) }} quintals</p>
        <p class="text-sm text-gray-600 mt-2">Based on average yield per acre</p>
      </div>

      <div class="bg-yellow-50 p-6 rounded-xl shadow-lg border-2 border-yellow-200">
        <h3 class="text-2xl font-bold text-yellow-800 mb-3 flex items-center gap-2">
          <span class="text-3xl">ğŸ’°</span> Estimated Total Cost
        </h3>
        <p class="text-4xl font-bold text-yellow-700">â‚¹{{ "{:,.2f}".format(total_cost) }}</p>
        <p class="text-sm text-gray-600 mt-2">Total investment required</p>
      </div>

      <div class="bg-white p-6 rounded-xl shadow-lg border-2 border-gray-200">
        <h3 class="text-2xl font-bold text-gray-800 mb-4 flex items-center gap-2">
          <span class="text-3xl">ğŸ“¦</span> Cost Breakdown
        </h3>
        <div class="space-y-3">
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸŒ¾</span> Seeds:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.seeds) }}</span>
          </div>
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸ§ª</span> Fertilizers:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.fertilizers) }}</span>
          </div>
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸ’§</span> Water:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.water) }}</span>
          </div>
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸ‘·</span> Labor:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.labor) }}</span>
          </div>
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸšœ</span> Machinery:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.machinery) }}</span>
          </div>
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸ¦Ÿ</span> Pesticides:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.pesticides) }}</span>
          </div>
          <div class="flex justify-between items-center pb-2 border-b border-gray-200">
            <span class="font-semibold text-gray-700"><span class="text-xl mr-2">ğŸšš</span> Transport:</span>
            <span class="text-lg font-bold text-gray-800">â‚¹{{ "{:,.2f}".format(cost_details.transport) }}</span>
          </div>
        </div>
        <div class="mt-4 pt-4 border-t-2 border-gray-300">
          <div class="flex justify-between items-center">
            <span class="text-xl font-bold text-gray-800">ğŸ’µ Grand Total:</span>
            <span class="text-2xl font-bold text-green-700">â‚¹{{ "{:,.2f}".format(cost_details.total) }}</span>
          </div>
        </div>
      </div>

      <!-- See Profit Button -->
      <div class="text-center">
        <button onclick="showProfit()" type="button" class="bg-gradient-to-r from-blue-600 to-blue-700 text-white text-lg px-10 py-4 rounded-full font-bold hover:from-blue-700 hover:to-blue-800 transition duration-300 shadow-lg hover:shadow-xl transform hover:scale-105">
          ğŸ’¹ See Profit Estimation
        </button>
      </div>

      <!-- Profit Section (Hidden by default) -->
      <div id="profitSection" style="display: none;" class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl shadow-lg border-2 border-blue-300">
        <h3 class="text-2xl font-bold text-blue-800 mb-4 flex items-center gap-2">
          <span class="text-3xl">ğŸ“ˆ</span> Market Price & Profit Estimation
        </h3>
        <div class="space-y-4">
          <div class="bg-white p-4 rounded-lg shadow">
            <p class="text-sm text-gray-600 mb-1">Market Price per Quintal</p>
            <p class="text-3xl font-bold text-blue-700">â‚¹{{ "{:,.2f}".format(market_price) }}</p>
          </div>
          <div class="bg-white p-4 rounded-lg shadow">
            <p class="text-sm text-gray-600 mb-1">Total Revenue ({{ "%.2f"|format(estimated_yield) }} quintals Ã— â‚¹{{ "{:,.2f}".format(market_price) }})</p>
            <p class="text-3xl font-bold text-green-700">â‚¹{{ "{:,.2f}".format(market_price * estimated_yield) }}</p>
          </div>
          <div class="bg-white p-4 rounded-lg shadow">
            <p class="text-sm text-gray-600 mb-1">Total Cost</p>
            <p class="text-3xl font-bold text-red-700">â‚¹{{ "{:,.2f}".format(total_cost) }}</p>
          </div>
          <div class="bg-gradient-to-r from-green-500 to-green-600 text-white p-5 rounded-lg shadow-xl">
            <p class="text-lg mb-2">ğŸ’° Net Profit</p>
            <p class="text-4xl font-bold">â‚¹{{ "{:,.2f}".format(profit) }}</p>
            {% if profit > 0 %}
            <p class="text-sm text-green-100 mt-2">âœ… Profitable crop choice!</p>
            {% elif profit < 0 %}
            <p class="text-sm text-red-100 mt-2">âš ï¸ Loss expected. Consider alternatives.</p>
            {% else %}
            <p class="text-sm text-yellow-100 mt-2">âš–ï¸ Break-even situation</p>
            {% endif %}
          </div>
        </div>
      </div>

    </div>
    {% elif crop %}
    <div class="mt-6 bg-red-50 border-2 border-red-200 p-4 rounded-xl text-center">
      <p class="text-red-700 font-semibold">âš ï¸ No cost data available for {{ crop }}. Please contact admin.</p>
    </div>
    {% endif %}

    <!-- Navigation Buttons -->
    <div class="text-center mt-8 flex gap-4 justify-center flex-wrap">
      <a href="/" class="inline-block bg-gray-700 text-white text-lg px-8 py-3 rounded-full hover:bg-gray-800 transition shadow-lg">
        ğŸ  Home
      </a>
      {% if crop %}
      <a href="/compare-crops" class="inline-block bg-blue-600 text-white text-lg px-8 py-3 rounded-full hover:bg-blue-700 transition shadow-lg">
        âš–ï¸ Compare Crops
      </a>
      {% endif %}
      {% if session.get('username') %}
      <a href="/dashboard" class="inline-block bg-green-600 text-white text-lg px-8 py-3 rounded-full hover:bg-green-700 transition shadow-lg">
        ğŸ“Š Dashboard
      </a>
      {% endif %}
    </div>

  </div>

  <script>
    function validateForm() {
      let landArea = document.getElementById("land_area").value;
      if (landArea.trim() === "" || parseFloat(landArea) <= 0) {
        alert("Please enter a valid land area.");
        return false;
      }
      return true;
    }

    function showProfit() {
      document.getElementById("profitSection").style.display = "block";
    }
  </script>

  <!-- ğŸŒ Google Translate Script -->
  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'en,mr,hi,ta,te,kn,gu,bn,pa',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE
      }, 'google_translate_element');
    }
  </script>

  <script src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>
